#tag ClassProtected Class CColumnResizeInherits StyleGrid	#tag Event		Function MouseDown(x as Integer,y as Integer,isRightButton as Boolean) As Boolean		  // Everything in this class is based on the original work of 		  // Hasan Edain, his work was done for Groundlevel Software.		  //		  // If you want to use this class together with CGridSort then 		  // make CGridSort inherit from CColumnResize and then make		  // your Grid inherit from CGridSort.		  		  Dim CellX, CellY As Integer		  Dim theTop, theLeft, theWidth, theHeight As Integer		  Dim positionInCell As Integer		  		  if m_AltCurs then		    m_Adjusting = true		    		    CellFromPoint(X, Y, CellX, CellY)		    CellBounds(cellX,0, theLeft,theTop,theWidth, theHeight)		    		    positionInCell = X - theLeft		    //On Left Boundary of Cell?		    if positionInCell <= 5 then		      m_TheLeftColumn = CellX-1		      m_TheRightColumn = CellX		    end if		    //On Right Boundary of Cell?		    if theWidth - positionInCell <= 5 then		      m_TheLeftColumn = CellX		      m_TheRightColumn = CellX + 1		    end if		    		    m_StartX = X		    m_StartLeftColSize = Column(m_TheLeftColumn).Width		    m_StartRightColSize = Column(m_TheRightColumn).Width		    		    CancelEventAction = true		    return true		  else		    m_Adjusting = false		    return MouseDown(x,y)		  end if		  		  		End Function	#tag EndEvent	#tag Event		Function MouseDrag(x as Integer,y as Integer) As Boolean		  // Everything in this class is based on the original work of 		  // Hasan Edain, his work was done for Groundlevel Software.		  //		  // If you want to use this class together with CGridSort then 		  // make CGridSort inherit from CColumnResize and then make		  // your Grid inherit from CGridSort.		  		  Dim change As Integer		  Dim scrollBarWidth As Integer		  Dim HeaderMoved, leftSizeGood, rightSizeGood As Boolean		  		  scrollBarWidth = 14  //Replace with constant in real code		  		  If m_Adjusting Then		    		    change = m_StartX - X		    If (m_StartLeftColSize - change) <= Column(m_TheLeftColumn).MinWidth Then		      change = m_StartLeftColSize - Column(m_TheLeftColumn).MinWidth		    End If		    		    If (m_StartRightColSize + change) <=  Column(m_TheRightColumn).MinWidth Then		      change = -1*(m_StartRightColSize - Column(m_TheRightColumn).MinWidth)		    End If		    		    If (x < (width - scrollBarWidth)) Then		      If Column(m_TheLeftColumn).Width <> (m_StartLeftColSize - change) Then		        HeaderMoved = True		      Else		        HeaderMoved = False		      End If		      		      If headerMoved Then		        LockDrawing = True		        Column(m_TheLeftColumn).Width = m_StartLeftColSize - change		        Column(m_TheRightColumn).Width = m_StartRightColSize + change		        LockDrawing = False		      End If		    End If		    Return True		  Else		    Return MouseDrag(x,y)		  End If		End Function	#tag EndEvent	#tag Event		Sub MouseMove(x as Integer,y as Integer)		  InternalMouseMove X,Y		End Sub	#tag EndEvent	#tag Event		Sub MouseUp(x as Integer,y as Integer)		  // Here we call InternalMouseMove to see if the Cursor		  // should be changed.		  InternalMouseMove x,y		  		  MouseUp x,y		End Sub	#tag EndEvent	#tag Event		Sub Open()		  // Everything in this class is based on the original work of 		  // Hasan Edain, his work was done for Groundlevel Software.		  //		  // If you want to use this class together with CGridSort then 		  // make CGridSort inherit from CColumnResize and then make		  // your Grid inherit from CGridSort.		  		  m_AltCurs = false		  		  Open		End Sub	#tag EndEvent	#tag Method, Flags = &h21		Private Sub InternalMouseMove(x as Integer,y as Integer)		  // Everything in this class is based on the original work of		  // Hasan Edain, his work was done for Groundlevel Software.		  //		  // If you want to use this class together with CGridSort then		  // make CGridSort inherit from CColumnResize and then make		  // your Grid inherit from CGridSort.		  		  Dim CellX, CellY As integer		  Dim theTop, theLeft, theWidth, theHeight As integer		  Dim positionInCell As integer		  Dim ScrollWidthOffset, ScrollHeightOffset As integer		  Dim bUseAltCurs as Boolean		  		  CellFromPoint(X, Y , CellX, CellY)		  		  if CellY = 0 then		    // We only do processor time consuming operations if		    // we know that we are in the header.		    if CellX > 0 and CellX < me.Cols then		      CellBounds(cellX,0, theLeft,theTop,theWidth, theHeight)		      		      if CellX <= Cols and CellY <= Rows and cellY = 0 then		        ScrollWidthOffset = me.width - 15		        ScrollHeightOffset = me.height - 15		        if ( X < ScrollWidthOffset ) and ( Y < ScrollHeightOffset ) and X > 5then		          positionInCell = X - theLeft		          //On Left Boundary of Cell?		          if positionInCell <= 5 then		            bUseAltCurs = true		          end if		          //On Right Boundary of Cell?		          if theWidth - positionInCell <= 5 then		            bUseAltCurs = true		          end if		        end if		      end if		    end if		  end if		  if m_AltCurs <> bUseAltCurs then		    // Here we are determining if a cursor change is really		    // needed to save processor time if its not needed.		    		    m_AltCurs = bUseAltCurs		    if m_AltCurs then		      MouseCursor = adjust		    else		      'MouseCursor = arrowCursor		      MouseCursor = system.Cursors.StandardPointer		    end if		    		    		    		  end if		End Sub	#tag EndMethod	#tag Hook, Flags = &h0		Event MouseDown(x as Integer, y as Integer) As Boolean	#tag EndHook	#tag Hook, Flags = &h0		Event MouseDrag(x as Integer,y as Integer) As Boolean	#tag EndHook	#tag Hook, Flags = &h0		Event MouseUp(x as Integer, y as Integer)	#tag EndHook	#tag Hook, Flags = &h0		Event Open()	#tag EndHook	#tag Property, Flags = &h21		Private m_Adjusting As boolean	#tag EndProperty	#tag Property, Flags = &h21		Private m_AltCurs As Boolean	#tag EndProperty	#tag Property, Flags = &h21		Private m_StartLeftColSize As Integer	#tag EndProperty	#tag Property, Flags = &h21		Private m_StartRightColSize As Integer	#tag EndProperty	#tag Property, Flags = &h21		Private m_StartX As Integer	#tag EndProperty	#tag Property, Flags = &h21		Private m_TheLeftColumn As Integer	#tag EndProperty	#tag Property, Flags = &h21		Private m_TheRightColumn As Integer	#tag EndProperty	#tag ViewBehavior		#tag ViewProperty			Name="AreaSelection"			Visible=true			Group="Selection"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="AutoDeactivate"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="CellEvenColor"			Visible=true			Group="Colors"			Type="Color"			EditorType="Color"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="CellOddColor"			Visible=true			Group="Colors"			Type="Color"			EditorType="Color"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="Cols"			Visible=true			Group="Appearance"			Type="Integer"			EditorType="Integer"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="CornerBtnEnabled"			Visible=true			Group="CornerButton"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="DefaultColumnWidth"			Visible=true			Group="Appearance"			Type="Integer"			EditorType="Integer"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="DefaultRowHeight"			Visible=true			Group="Appearance"			Type="Integer"			EditorType="Integer"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="Enabled"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="EvenBackColor"			Visible=true			Group="Colors"			Type="Color"			EditorType="Color"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="FreezeCols"			Visible=true			Group="Appearance"			Type="Integer"			EditorType="Integer"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="GetFocusOnClick"			Visible=true			Group="Appearance"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="GridLineColor"			Visible=true			Group="Colors"			Type="Color"			EditorType="Color"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="HasBackColor"			Visible=true			Group="Colors"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="HasCellGridLineColor"			Visible=true			Group="Colors"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="HasHeader"			Visible=true			Group="Appearance"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="HasInactiveSelectionColor"			Visible=true			Group="Colors"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="HasOutOfBoundsGridLineColor"			Visible=true			Group="Colors"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="HasSelectedTextColor"			Visible=true			Group="Colors"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="HasSelectionColor"			Visible=true			Group="Colors"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="Height"			Visible=true			Group="Position"			InitialValue="100"			Type="Integer"			EditorType="Integer"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="HelpTag"			Visible=true			Group="Appearance"			Type="String"			EditorType="MultiLineEditor"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="HorizontalGrid"			Visible=true			Group="Grid lines"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="HorizontalScrollbar"			Visible=true			Group="Appearance"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="HotTrack"			Visible=true			Group="Selection"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="InactiveSelectionColor"			Visible=true			Group="Colors"			Type="Color"			EditorType="Color"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			Type="Integer"			EditorType="Integer"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="InitialParent"			Group="Position"			Type="String"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			Type="Integer"			EditorType="Integer"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="LiveScroll"			Visible=true			Group="Behavior"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="LockBottom"			Visible=true			Group="Position"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="LockLeft"			Visible=true			Group="Position"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="LockRight"			Visible=true			Group="Position"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="LockTop"			Visible=true			Group="Position"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			Type="String"			EditorType="String"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="OddBackColor"			Visible=true			Group="Colors"			Type="Color"			EditorType="Color"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="OutOfBoundsGridLineColor"			Visible=true			Group="Colors"			Type="Color"			EditorType="Color"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="PopupMenuCellFullSensitivity"			Visible=true			Group="Behavior"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="RenderSortOrder"			Visible=true			Group="CornerButton"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="Rows"			Visible=true			Group="Appearance"			Type="Integer"			EditorType="Integer"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="SelectedTextColor"			Visible=true			Group="Colors"			Type="Color"			EditorType="Color"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="SelectEntireRow"			Visible=true			Group="Selection"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="SelectionColor"			Visible=true			Group="Colors"			Type="Color"			EditorType="Color"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="ShadeSelection"			Visible=true			Group="Selection"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="ShowResizeGlyph"			Visible=true			Group="Appearance"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="StartupCocoaFont"			Visible=true			Group="Font"			Type="String"			EditorType="String"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="StartupLinuxFont"			Visible=true			Group="Font"			Type="String"			EditorType="String"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="StartupLinuxFontSize"			Visible=true			Group="Font"			Type="Integer"			EditorType="Integer"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="StartupMacFont"			Visible=true			Group="Font"			Type="String"			EditorType="String"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="StartupMacFontSize"			Visible=true			Group="Font"			Type="Integer"			EditorType="Integer"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="StartupWin32Font"			Visible=true			Group="Font"			Type="String"			EditorType="String"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="StartupWin32FontSize"			Visible=true			Group="Font"			Type="Integer"			EditorType="Integer"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			Type="String"			EditorType="String"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="TabIndex"			Visible=true			Group="Position"			InitialValue="0"			Type="Integer"			EditorType="Integer"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="TabPanelIndex"			Group="Position"			InitialValue="0"			Type="Integer"			EditorType="Integer"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="TabStop"			Visible=true			Group="Position"			InitialValue="True"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			Type="Integer"			EditorType="Integer"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="UseFocusRing"			Visible=true			Group="Appearance"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="VerticalGrid"			Visible=true			Group="Grid lines"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="VerticalScrollbar"			Visible=true			Group="Appearance"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="Visible"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			EditorType="Boolean"			InheritedFrom="StyleGrid"		#tag EndViewProperty		#tag ViewProperty			Name="Width"			Visible=true			Group="Position"			InitialValue="150"			Type="Integer"			EditorType="Integer"			InheritedFrom="StyleGrid"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass