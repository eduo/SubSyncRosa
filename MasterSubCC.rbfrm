#tag WindowBegin ContainerControl MasterSubCC   AcceptFocus     =   False   AcceptTabs      =   True   AutoDeactivate  =   True   BackColor       =   16777215   Backdrop        =   0   Enabled         =   True   EraseBackground =   True   HasBackColor    =   False   Height          =   377   HelpTag         =   ""   InitialParent   =   ""   Left            =   32   LockBottom      =   True   LockLeft        =   True   LockRight       =   True   LockTop         =   True   TabIndex        =   0   TabPanelIndex   =   0   TabStop         =   True   Top             =   48   UseFocusRing    =   False   Visible         =   True   Width           =   446   Begin GroupBox GroupBox1      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Master Sub"      Enabled         =   True      Height          =   377      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   34      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   0      Underline       =   ""      Visible         =   True      Width           =   412      Begin CheckBox adjustAllCheckbox         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "Adjust all Lines"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         Italic          =   ""         Left            =   48         LockBottom      =   True         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   False         Scope           =   0         State           =   1         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "SmallSystem"         TextSize        =   0         TextUnit        =   0         Top             =   344         Underline       =   ""         Value           =   True         Visible         =   True         Width           =   188      End      Begin PushButton PushButton1         AutoDeactivate  =   True         Bold            =   ""         ButtonStyle     =   0         Cancel          =   ""         Caption         =   "Sync with this sub"         Default         =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         Italic          =   ""         Left            =   263         LockBottom      =   True         LockedInPosition=   False         LockLeft        =   False         LockRight       =   True         LockTop         =   False         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   341         Underline       =   ""         Visible         =   True         Width           =   144      End      Begin PopupMenu charSetMenuMaster         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   False         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         InitialValue    =   ""         Italic          =   ""         Left            =   231         ListIndex       =   0         LockBottom      =   True         LockedInPosition=   False         LockLeft        =   False         LockRight       =   True         LockTop         =   False         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   310         Underline       =   ""         Visible         =   True         Width           =   176      End      Begin Label Label1         AutoDeactivate  =   True         Bold            =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   False         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         Italic          =   ""         Left            =   48         LockBottom      =   True         LockedInPosition=   False         LockLeft        =   False         LockRight       =   True         LockTop         =   False         Multiline       =   ""         Scope           =   0         Selectable      =   False         TabIndex        =   3         TabPanelIndex   =   0         TabStop         =   True         Text            =   "Re-Open with encoding:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "SmallSystem"         TextSize        =   0         TextUnit        =   0         Top             =   312         Transparent     =   False         Underline       =   ""         Visible         =   True         Width           =   171      End      Begin SubGridBox masterSubList         AreaSelection   =   False         AutoDeactivate  =   True         CellEvenColor   =   13421772         CellOddColor    =   13421772         Cols            =   3         CornerBtnEnabled=   False         DefaultColumnWidth=   0         DefaultRowHeight=   50         Enabled         =   True         EvenBackColor   =   13421772         FreezeCols      =   0         GetFocusOnClick =   True         GridLineColor   =   13421772         HasBackColor    =   False         HasCellGridLineColor=   True         HasHeader       =   True         HasInactiveSelectionColor=   False         HasOutOfBoundsGridLineColor=   False         HasSelectedTextColor=   False         HasSelectionColor=   False         Height          =   268         HelpTag         =   ""         HorizontalGrid  =   True         HorizontalScrollbar=   False         HotTrack        =   False         InactiveSelectionColor=   13421772         Index           =   -2147483648         InitialParent   =   "GroupBox1"         Left            =   48         LiveScroll      =   True         LockBottom      =   True         LockedInPosition=   False         LockLeft        =   True         LockRight       =   True         LockTop         =   True         mode            =   """""new"""""         OddBackColor    =   13421772         OutOfBoundsGridLineColor=   13421772         PopupMenuCellFullSensitivity=   False         RenderSortOrder =   False         Rows            =   0         Scope           =   0         SelectedTextColor=   0         selectEndRow    =   -1         SelectEntireRow =   True         SelectionColor  =   13421772         selectStartRow  =   -1         ShadeSelection  =   False         ShowResizeGlyph =   False         StartupCocoaFont=   "SmallSystem"         StartupLinuxFont=   "Geneva"         StartupLinuxFontSize=   9         StartupMacFont  =   "SmallSystem"         StartupMacFontSize=   10         StartupWin32Font=   "MS Sans Serif"         StartupWin32FontSize=   9         TabIndex        =   4         TabPanelIndex   =   0         TabStop         =   True         Top             =   32         UseFocusRing    =   True         VerticalGrid    =   False         VerticalScrollbar=   True         Visible         =   True         Width           =   384      End   End   Begin clickCanvas CanvasStart      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   1010445406      clicked         =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   28      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   3      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   True      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Top             =   33      UseFocusRing    =   True      Visible         =   True      Width           =   28   End   Begin clickCanvas CanvasEnd      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   1448241214      clicked         =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   28      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   3      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   True      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      Top             =   72      UseFocusRing    =   True      Visible         =   True      Width           =   28   End   Begin clickCanvas CanvasEnd14      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   1692790638      clicked         =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   28      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   3      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   True      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Top             =   263      UseFocusRing    =   True      Visible         =   True      Width           =   28   End   Begin clickCanvas CanvasEnd13      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   952445518      clicked         =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   28      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   3      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   True      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      Top             =   111      UseFocusRing    =   True      Visible         =   True      Width           =   28   End   Begin clickCanvas CanvasEnd12      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   868914216      clicked         =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   28      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   3      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   True      Scope           =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      Top             =   223      UseFocusRing    =   True      Visible         =   True      Width           =   28   End   Begin clickCanvas CanvasEnd121      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   280663789      clicked         =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   28      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   3      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   True      Scope           =   0      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   True      Top             =   151      UseFocusRing    =   True      Visible         =   True      Width           =   28   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Open()		  'Dim subFile1,subFile2 As FolderItem		  '		  		  charSetMenuMaster.ListIndex = charSetMenuMaster.ListIndex		  		End Sub	#tag EndEvent	#tag Event		Sub Resized()		  masterSubList.LockDrawing = true		  masterSubList.AdjustListBoxSize(10)		  masterSubList.LockDrawing = false		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub loadNewSub()		  Dim dlg As OpenDialog		  dlg=New OpenDialog		  		  'While subfile2 Is Nil		  #If Not (TargetLinux) Then		    dlg.InitialDirectory=SpecialFolder.Documents		  #Else   //open Home directory on linux		    dlg.InitialDirectory=SpecialFolder.Home		  #EndIf		  dlg.Title="Select a master SRT file to use as a guide."		  dlg.Filter=FileTypes.Subtitle //Defined as file type in FileTypes1.		  subFile2=dlg.ShowModal		  'subFile2 = New FolderItem("/Volumes/TV-MOVIES/Movies/TEMP/Black Swan/Black Swan.en.srt",FolderItem.PathTypeShell)		  		  'Wend		  		  Dim mySub As subclass		  mySub = New subClass		  mySub.processSubFile(subfile2)		  masterSubList.mySub = mySub		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub loadNewSub(thisSub as FolderItem)		  		  subfile2=thisSub		  		  Dim mySub As subclass		  mySub = New subClass		  mySub.processSubFile(subfile2)		  masterSubList.mySub = mySub		  		  'end if		End Sub	#tag EndMethod	#tag Property, Flags = &h0		subfile2 As folderitem	#tag EndProperty#tag EndWindowCode#tag Events adjustAllCheckbox	#tag Event		Sub Action()		  if self.Parent isa subWindow then		    subwindow(self.parent).calculateAdjustment		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events PushButton1	#tag Event		Sub Action()		  If Self.window IsA subWindow Then		    		    Dim MainWindow As subWindow = subwindow(Self.window)		    		    Dim sl As SubGridBox = MainWindow.mainSubList		    Dim ml As SubGridBox = masterSubList		    MainWindow.subProgressWheel.Visible = True		    sl.updateSubTimings(sl.selectStartRow,ml.mySub.subLines(ml.selectStartRow-1).startSeconds, _		    sl.selectEndRow,ml.mySub.subLines(ml.selectEndRow-1).startSeconds, _		    ml.mySub.subLines(ml.selectStartRow-1).startSeconds-sl.mySub.subLines(sl.selectStartRow-1).startSeconds,adjustAllCheckbox.Value)		    MainWindow.subProgressWheel.Visible = False		    		    ml.VScrollValue=ml.selectStartRow		    ml.Refresh		    		    sl.VScrollValue=sl.selectStartRow		    sl.Refresh		    		    subWindow(Self.window).ContentsChanged = True		    		  End If		End Sub	#tag EndEvent#tag EndEvents#tag Events charSetMenuMaster	#tag Event		Sub Change()		  dim sl as SubGridBox = masterSubList		  		  if sl.rows > 0 then		    if me.ListIndex > -1 then		      dim thisValue as variant = me.RowTag(me.ListIndex)		      		      sl.LockDrawing = True		      		      if thisValue <> nil then		        If not thisValue isa TextEncoding then		          if thisValue = "auto" Then		            sl.mySub.Encoding = Nil		            sl.ParseSubtitle(sl.mySub.subFile)		            dim ok as boolean		            ok = sl.paintRows(1,1)		            sl.AdjustListBoxSize(10)		          end if		        Elseif thisValue IsA TextEncoding then		          if thisValue = sl.mySub.Encoding Then		          Else		            sl.mysub.Encoding = thisValue		            sl.ParseSubtitle(sl.mySub.subFile)		            'system.Log(system.LogLevelError,"Finished")		            dim ok as boolean		            ok = sl.paintRows(1,1)		            sl.AdjustListBoxSize(10)		            		          end if		        End If		      end if		      sl.LockDrawing = False		    end if		  end if		  		  Dim thisEnc As TextEncoding = sl.mySub.Encoding		  For i As Integer = 0 To me.ListCount -1		    		    If me.RowTag(i) IsA TextEncoding Then		      If me.RowTag(i)= thisEnc Then		        me.ListIndex = i		        Exit For i		      End If		    End If		  Next		  		  		End Sub	#tag EndEvent	#tag Event		Sub Open()		  'for i as integer = 0 to encodings.Count -1		  'me.AddRow(encodings.item(i).internetName + "/" + str(encodings.item(i).code))		  'next		  		  me.AddRow("UTF8")		  me.RowTag(me.listcount -1)=encodings.UTF8		  me.AddRow("ISOLatin1")		  me.RowTag(me.listcount -1)=encodings.ISOLatin1		  me.AddSeparator		  me.AddRow("Auto-Detect")		  me.RowTag(me.listcount -1)="auto"		End Sub	#tag EndEvent#tag EndEvents#tag Events masterSubList	#tag Event		Sub AfterMouseDown(x as Integer,y as Integer,isHeader as Boolean)		  if y > me.rows then		  else		    if Keyboard.AltKey or Keyboard.ShiftKey then		      if self.parent isa subWindow then subWindow(self.Parent).calculateAdjustment		    end		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events CanvasStart	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  if self.parent isa subWindow then		    if subWindow(self.parent).MainSubList.selectStartRow > -1 then subWindow(self.parent).MainSubList.VScrollValue=subWindow(self.parent).MainSubList.selectStartRow		  end if		  if masterSubList.selectStartRow > -1 then masterSubList.VScrollValue=masterSubList.selectStartRow		  		End Function	#tag EndEvent#tag EndEvents#tag Events CanvasEnd	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  if self.parent isa subWindow then		    if subWindow(self.parent).MainSubList.selectEndRow > -1 then 		      subWindow(self.parent).MainSubList.VScrollValue=Min(subWindow(self.parent).MainSubList.selectEndRow,subWindow(self.parent).MainSubList.selectEndRow-5)		    end if		  end if		  if masterSubList.selectEndRow > -1 then masterSubList.VScrollValue=min(masterSubList.selectEndRow,masterSubList.selectEndRow-5)		  		End Function	#tag EndEvent#tag EndEvents#tag Events CanvasEnd14	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  if self.parent isa subWindow then		    subWindow(self.parent).mainSubList.VScrollValue=subWindow(self.parent).mainSubList.rows		  end if		  masterSubList.VScrollValue=masterSubList.rows		  		End Function	#tag EndEvent#tag EndEvents#tag Events CanvasEnd13	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  if self.parent isa subWindow then		    if subWindow(self.parent).MainSubList.selectEndRow > -1 then		      subWindow(self.parent).MainSubList.VScrollValue=Min(subWindow(self.parent).MainSubList.selectEndRow,subWindow(self.parent).MainSubList.selectEndRow-5)		    end if		  end if		  if masterSubList.selectEndRow > -1 then masterSubList.VScrollValue=min(masterSubList.selectEndRow,masterSubList.selectEndRow-5)		  		End Function	#tag EndEvent#tag EndEvents#tag Events CanvasEnd12	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  if self.parent isa subWindow then		    subWindow(self.parent).mainSubList.VScrollValue=1		  end if		  masterSubList.VScrollValue=1		  		End Function	#tag EndEvent#tag EndEvents#tag Events CanvasEnd121	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  if self.parent isa subWindow then		    subWindow(self.parent).mainSubList.VScrollValue=1		  end if		  masterSubList.VScrollValue=1		  		End Function	#tag EndEvent#tag EndEvents