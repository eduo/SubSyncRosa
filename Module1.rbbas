#tag ModuleProtected Module Module1	#tag Method, Flags = &h0		Sub AdjustListBoxSize(extends sg as StyleGrid, iDefaultRowSize as integer)		  dim tempStr, cellData as string		  dim curRow, curCol, cellSpan, cellWidth, cellHeight, rowHeight, x, nEndCol as integer		  dim NewRowHeight as integer		  dim p as picture		  dim g as graphics		  Dim pStyle as StyleGridStyle		  		  tempStr = ""		  for curRow = 1 to sg.rows		    for curCol = 1 to sg.cols		      pStyle = sg.cell(curCol, curRow).Style		      		      'Encodings		      dim thisText as string = sg.cell(curCol, curRow).Text		      dim thisEnc as string = sg.cell(curCol, curRow).Text.Encoding.internetName		      cellData = DefineEncoding(thisText,thisEnc.Encoding)		      		      cellSpan = sg.row(curRow).CellColSpan(curCol)		      if cellSpan = 1 then		        dim thisWidth as integer = sg.Column(curCol).Width		        cellWidth = thisWidth		      else		        cellWidth = 0		        nEndCol = curCol + cellSpan		        if nEndCol > sg.Cols then		          nEndCol = sg.cols		        end		        		        for x = curCol to nEndCol		          cellWidth = cellWidth + sg.Column(x).Width		        next		      end		      		      #if TargetMacOS then		        cellHeight = Max(pStyle.FontSize, 14) + Max(pStyle.FontSize, 14)*2/3		      #endif		      		      #if TargetWin32 then		        cellHeight = Max(pStyle.FontSize, 14)*2		      #endif		      p = newpicture(cellWidth, cellHeight, 32)		      if p <> nil then		        g = p.graphics		        g.textFont = pStyle.FontName		        g.textSize = pStyle.FontSize		        g.bold = pStyle.FontBold		        g.italic = pStyle.FontItalic		        g.Underline = pStyle.fontUnderline		        'rowHeight = g.stringHeight(cellData, cellWidth) * 1.5 '12 Nov 03 added padding		        rowHeight = g.stringHeight(cellData, cellWidth) + 14  '12 Nov 03 added padding		        NewRowHeight = max(rowHeight, iDefaultRowSize)		      end		      		      sg.Row(curRow).Cell(curCol).TopIndent = 7		      		    next		    sg.rowHeight(curRow) = NewRowHeight		    NewRowHeight = 0		  next		  		End Sub	#tag EndMethod	#tag ViewBehavior		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="2147483648"			Type="Integer"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			Type="Integer"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			Type="String"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			Type="String"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			Type="Integer"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Module#tag EndModule